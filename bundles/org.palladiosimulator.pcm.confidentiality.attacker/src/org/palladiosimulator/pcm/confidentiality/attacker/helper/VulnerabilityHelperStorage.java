package org.palladiosimulator.pcm.confidentiality.attacker.helper;

import java.util.HashMap;
import java.util.List;

import org.palladiosimulator.pcm.confidentiality.attackerSpecification.attackSpecification.Vulnerability;

public class VulnerabilityHelperStorage {
	
	private static VulnerabilityHelperStorage singleton;
	
	private HashMap<String, List<Vulnerability>> vulnarabilityHashMap;
		
	private VulnerabilityHelperStorage() {
		vulnarabilityHashMap = new HashMap<>();
	}
	
	public static synchronized VulnerabilityHelperStorage getInstance() {
		if (singleton == null) {
			singleton = new VulnerabilityHelperStorage();
		}
		
		return singleton;
	}

	public void reset() {
		vulnarabilityHashMap = new HashMap<>();
		vulnarabilityHashMap.clear();
	}
	
	//IMPORTANT: HashMap is unsynchronized, so synchronization must be done here.
	public synchronized void put(String key, List<Vulnerability> value) {
		vulnarabilityHashMap.put(key, value);
	}
	
	public List<Vulnerability> get(String key) {
		return vulnarabilityHashMap.get(key);
	}
	
	public boolean contains(String key) {
		return vulnarabilityHashMap.containsKey(key);
	}
}
